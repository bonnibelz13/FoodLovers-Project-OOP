package code.loginform;




import static code.loginform.RegistrationSystem.isEmailValid;
import static code.loginform.RegistrationSystem.isUsernameValid;
import com.google.firebase.FirebaseApp;


import java.util.logging.Level;
import java.util.logging.Logger;

import javax.swing.*;



import static code.connection.Connection.initFirebase;
import java.io.IOException;

import com.google.firebase.database.DatabaseReference;




    // ----------------------------------------------------------------
    // REGISTERFORM
    // ----------------------------------------------------------------




public class RegisterForm extends javax.swing.JFrame {
    
    private DatabaseReference mDatabase;
    private RegistrationSystem registrationSystem;
    

    
    public RegisterForm() {
        initComponents();
        setLocationRelativeTo(null);
        
        registrationSystem = new RegistrationSystem();
        registrationSystem.setRegisterForm(this);
        
        try {
            initFirebase();
        } catch (IOException ex) {
            Logger.getLogger(RegisterForm.class.getName()).log(Level.SEVERE, null, ex);
        }
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jPanel5 = new javax.swing.JPanel();
        jPanel1 = new javax.swing.JPanel();
        jPanel3 = new javax.swing.JPanel();
        jPanel2 = new javax.swing.JPanel();
        jTextField_Username = new javax.swing.JTextField();
        jLabel4 = new javax.swing.JLabel();
        jLabel5 = new javax.swing.JLabel();
        jPasswordtField_Password = new javax.swing.JPasswordField();
        jLabel6 = new javax.swing.JLabel();
        jPasswordField_ConfirmPassword = new javax.swing.JPasswordField();
        jLabel2 = new javax.swing.JLabel();
        jLabelLoginForm = new javax.swing.JLabel();
        jButtonSignUp = new javax.swing.JButton();
        jLabel_Username_Message = new javax.swing.JLabel();
        jLabel_Password_Message = new javax.swing.JLabel();
        jLabel_ConPassword_Message = new javax.swing.JLabel();
        status_request_lbl = new javax.swing.JLabel();
        jLabel_Email = new javax.swing.JLabel();
        jLabel_Email_Message = new javax.swing.JLabel();
        jTextField_Email = new javax.swing.JTextField();
        jLabel3 = new javax.swing.JLabel();
        jPanel4 = new javax.swing.JPanel();
        jLabel1 = new javax.swing.JLabel();
        jPanel6 = new javax.swing.JPanel();
        jLabel9 = new javax.swing.JLabel();
        jLabelClose = new javax.swing.JLabel();
        jLabelMin = new javax.swing.JLabel();
        jLabel7 = new javax.swing.JLabel();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
        setUndecorated(true);

        jPanel5.setBackground(new java.awt.Color(246, 246, 246));
        jPanel5.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        jPanel1.setBackground(new java.awt.Color(249, 249, 249));
        jPanel1.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        jPanel3.setBackground(new java.awt.Color(255, 255, 255));
        jPanel3.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        jPanel2.setBackground(new java.awt.Color(255, 255, 255));
        jPanel2.setForeground(new java.awt.Color(255, 255, 255));
        jPanel2.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        jTextField_Username.setBackground(java.awt.SystemColor.control);
        jTextField_Username.setFont(new java.awt.Font("Microsoft Tai Le", 1, 14)); // NOI18N
        jTextField_Username.setForeground(new java.awt.Color(102, 102, 255));
        jTextField_Username.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jTextField_UsernameActionPerformed(evt);
            }
        });
        jPanel2.add(jTextField_Username, new org.netbeans.lib.awtextra.AbsoluteConstraints(50, 190, 251, 36));

        jLabel4.setBackground(new java.awt.Color(0, 0, 0));
        jLabel4.setFont(new java.awt.Font("Microsoft Tai Le", 0, 14)); // NOI18N
        jLabel4.setText("Username");
        jPanel2.add(jLabel4, new org.netbeans.lib.awtextra.AbsoluteConstraints(50, 160, -1, -1));

        jLabel5.setBackground(new java.awt.Color(0, 0, 0));
        jLabel5.setFont(new java.awt.Font("Microsoft Tai Le", 0, 14)); // NOI18N
        jLabel5.setText("Password");
        jPanel2.add(jLabel5, new org.netbeans.lib.awtextra.AbsoluteConstraints(50, 250, -1, -1));

        jPasswordtField_Password.setBackground(java.awt.SystemColor.control);
        jPasswordtField_Password.setFont(new java.awt.Font("Microsoft Tai Le", 1, 14)); // NOI18N
        jPasswordtField_Password.setForeground(new java.awt.Color(102, 102, 255));
        jPanel2.add(jPasswordtField_Password, new org.netbeans.lib.awtextra.AbsoluteConstraints(50, 280, 251, 40));

        jLabel6.setBackground(new java.awt.Color(0, 0, 0));
        jLabel6.setFont(new java.awt.Font("Microsoft Tai Le", 0, 14)); // NOI18N
        jLabel6.setText("Confirm Password ");
        jPanel2.add(jLabel6, new org.netbeans.lib.awtextra.AbsoluteConstraints(50, 350, -1, -1));

        jPasswordField_ConfirmPassword.setBackground(java.awt.SystemColor.control);
        jPasswordField_ConfirmPassword.setFont(new java.awt.Font("Microsoft Tai Le", 1, 14)); // NOI18N
        jPasswordField_ConfirmPassword.setForeground(new java.awt.Color(102, 102, 255));
        jPanel2.add(jPasswordField_ConfirmPassword, new org.netbeans.lib.awtextra.AbsoluteConstraints(50, 380, 251, 40));

        jLabel2.setFont(new java.awt.Font("Microsoft Tai Le", 0, 14)); // NOI18N
        jLabel2.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel2.setText("Already a member?");
        jPanel2.add(jLabel2, new org.netbeans.lib.awtextra.AbsoluteConstraints(80, 530, 130, 20));

        jLabelLoginForm.setFont(new java.awt.Font("Microsoft Tai Le", 1, 14)); // NOI18N
        jLabelLoginForm.setForeground(new java.awt.Color(70, 162, 255));
        jLabelLoginForm.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabelLoginForm.setText("Sign In ");
        jLabelLoginForm.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        jLabelLoginForm.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                jLabelLoginFormFormMouseClicked(evt);
            }
        });
        jPanel2.add(jLabelLoginForm, new org.netbeans.lib.awtextra.AbsoluteConstraints(210, 530, 60, 20));

        jButtonSignUp.setBackground(new java.awt.Color(138, 82, 229));
        jButtonSignUp.setFont(new java.awt.Font("Microsoft PhagsPa", 1, 14)); // NOI18N
        jButtonSignUp.setForeground(new java.awt.Color(255, 255, 255));
        jButtonSignUp.setText("Sign Up");
        jButtonSignUp.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                jButtonSignUpMouseClicked(evt);
            }
        });
        jPanel2.add(jButtonSignUp, new org.netbeans.lib.awtextra.AbsoluteConstraints(48, 450, 260, 47));

        jLabel_Username_Message.setFont(new java.awt.Font("Microsoft Tai Le", 0, 14)); // NOI18N
        jLabel_Username_Message.setForeground(new java.awt.Color(255, 0, 51));
        jLabel_Username_Message.setHorizontalAlignment(javax.swing.SwingConstants.LEFT);
        jPanel2.add(jLabel_Username_Message, new org.netbeans.lib.awtextra.AbsoluteConstraints(61, 226, 240, 20));

        jLabel_Password_Message.setFont(new java.awt.Font("Microsoft Tai Le", 0, 14)); // NOI18N
        jLabel_Password_Message.setForeground(new java.awt.Color(255, 0, 51));
        jLabel_Password_Message.setHorizontalAlignment(javax.swing.SwingConstants.LEFT);
        jPanel2.add(jLabel_Password_Message, new org.netbeans.lib.awtextra.AbsoluteConstraints(61, 320, 240, 20));

        jLabel_ConPassword_Message.setFont(new java.awt.Font("Microsoft Tai Le", 0, 14)); // NOI18N
        jLabel_ConPassword_Message.setForeground(new java.awt.Color(255, 0, 51));
        jLabel_ConPassword_Message.setHorizontalAlignment(javax.swing.SwingConstants.LEFT);
        jPanel2.add(jLabel_ConPassword_Message, new org.netbeans.lib.awtextra.AbsoluteConstraints(61, 420, 240, 20));
        jPanel2.add(status_request_lbl, new org.netbeans.lib.awtextra.AbsoluteConstraints(193, 523, -1, -1));

        jLabel_Email.setBackground(new java.awt.Color(0, 0, 0));
        jLabel_Email.setFont(new java.awt.Font("Microsoft Tai Le", 0, 14)); // NOI18N
        jLabel_Email.setText("E-mail");
        jPanel2.add(jLabel_Email, new org.netbeans.lib.awtextra.AbsoluteConstraints(49, 70, -1, -1));

        jLabel_Email_Message.setFont(new java.awt.Font("Microsoft Tai Le", 0, 14)); // NOI18N
        jLabel_Email_Message.setForeground(new java.awt.Color(255, 0, 51));
        jLabel_Email_Message.setHorizontalAlignment(javax.swing.SwingConstants.LEFT);
        jPanel2.add(jLabel_Email_Message, new org.netbeans.lib.awtextra.AbsoluteConstraints(61, 136, 240, 20));

        jTextField_Email.setBackground(java.awt.SystemColor.control);
        jTextField_Email.setFont(new java.awt.Font("Microsoft Tai Le", 1, 14)); // NOI18N
        jTextField_Email.setForeground(new java.awt.Color(102, 102, 255));
        jPanel2.add(jTextField_Email, new org.netbeans.lib.awtextra.AbsoluteConstraints(50, 100, 251, 36));

        jLabel3.setFont(new java.awt.Font("Leelawadee UI", 0, 18)); // NOI18N
        jLabel3.setForeground(new java.awt.Color(102, 102, 102));
        jLabel3.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabel3.setText("Sign up now and unlock exclusive access!");
        jPanel2.add(jLabel3, new org.netbeans.lib.awtextra.AbsoluteConstraints(-10, 10, 370, -1));

        jPanel3.add(jPanel2, new org.netbeans.lib.awtextra.AbsoluteConstraints(509, 56, 351, 585));

        jPanel4.setBackground(new java.awt.Color(255, 255, 255, 190));
        jPanel4.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        jLabel1.setIcon(new javax.swing.ImageIcon("C:\\Users\\baibu\\OneDrive\\Documents\\GitHub\\OOP-Project\\ProjectTest1\\src\\main\\java\\code\\icon\\Dribbble-2_2.gif")); // NOI18N
        jPanel4.add(jLabel1, new org.netbeans.lib.awtextra.AbsoluteConstraints(-10, 0, -1, 640));

        jPanel3.add(jPanel4, new org.netbeans.lib.awtextra.AbsoluteConstraints(0, 0, 470, 640));

        jPanel6.setBackground(new java.awt.Color(255, 255, 255, 250));
        jPanel6.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        jLabel9.setFont(new java.awt.Font("Leelawadee UI", 1, 24)); // NOI18N
        jLabel9.setForeground(new java.awt.Color(40, 40, 43));
        jLabel9.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabel9.setText("Create an account");
        jPanel6.add(jLabel9, new org.netbeans.lib.awtextra.AbsoluteConstraints(90, 22, 250, 40));

        jPanel3.add(jPanel6, new org.netbeans.lib.awtextra.AbsoluteConstraints(470, 0, 410, 80));

        jPanel1.add(jPanel3, new org.netbeans.lib.awtextra.AbsoluteConstraints(60, 70, 880, 640));

        jLabelClose.setBackground(new java.awt.Color(255, 255, 255));
        jLabelClose.setFont(new java.awt.Font("Leelawadee UI", 1, 24)); // NOI18N
        jLabelClose.setForeground(new java.awt.Color(153, 153, 153));
        jLabelClose.setText("x");
        jLabelClose.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        jLabelClose.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                jLabelCloseMouseClicked(evt);
            }
        });
        jPanel1.add(jLabelClose, new org.netbeans.lib.awtextra.AbsoluteConstraints(960, 5, 21, 23));

        jLabelMin.setBackground(new java.awt.Color(255, 255, 255));
        jLabelMin.setFont(new java.awt.Font("Leelawadee UI", 1, 24)); // NOI18N
        jLabelMin.setForeground(new java.awt.Color(153, 153, 153));
        jLabelMin.setText("-");
        jLabelMin.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        jLabelMin.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                jLabelMinMouseClicked(evt);
            }
        });
        jPanel1.add(jLabelMin, new org.netbeans.lib.awtextra.AbsoluteConstraints(929, 0, 25, -1));

        jLabel7.setIcon(new javax.swing.ImageIcon("C:\\Users\\baibu\\OneDrive\\Documents\\GitHub\\OOP-Project\\ProjectTest1\\src\\main\\java\\code\\icon\\element.png")); // NOI18N
        jPanel1.add(jLabel7, new org.netbeans.lib.awtextra.AbsoluteConstraints(0, 0, 1000, 780));

        jPanel5.add(jPanel1, new org.netbeans.lib.awtextra.AbsoluteConstraints(0, 0, -1, -1));

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addGap(0, 0, Short.MAX_VALUE)
                .addComponent(jPanel5, javax.swing.GroupLayout.PREFERRED_SIZE, 1000, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 0, Short.MAX_VALUE))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addGap(0, 0, Short.MAX_VALUE)
                .addComponent(jPanel5, javax.swing.GroupLayout.PREFERRED_SIZE, 780, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 0, Short.MAX_VALUE))
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void jLabelMinMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jLabelMinMouseClicked
        // TODO add your handling code here:
        this.setState(JFrame.ICONIFIED);
    }//GEN-LAST:event_jLabelMinMouseClicked

    private void jLabelCloseMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jLabelCloseMouseClicked
        // TODO add your handling code here:
        this.dispose();
        FirebaseApp.getInstance().delete();
        
        LoginForm lgf = new LoginForm();
        lgf.setVisible(true);
        lgf.pack();
        lgf.setLocationRelativeTo(null);
        lgf.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);

    }//GEN-LAST:event_jLabelCloseMouseClicked

    private void jTextField_UsernameActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jTextField_UsernameActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_jTextField_UsernameActionPerformed

    private void jLabelLoginFormFormMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jLabelLoginFormFormMouseClicked
        // TODO add your handling code here:
        this.dispose();
        FirebaseApp.getInstance().delete(); //disconnected to server firebase

        LoginForm lgf = new LoginForm();
        lgf.setVisible(true);

    }//GEN-LAST:event_jLabelLoginFormFormMouseClicked

//}
    private void jButtonSignUpMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jButtonSignUpMouseClicked
        String email = jTextField_Email.getText();
        String username = jTextField_Username.getText();
        String password = String.valueOf(jPasswordtField_Password.getPassword());
        String conpassword = String.valueOf(jPasswordField_ConfirmPassword.getPassword());
        

        jLabel_Email_Message.setText("Please enter email.");
        jLabel_Username_Message.setText("Please enter username.");
        jLabel_Password_Message.setText("Please enter password.");
        
        jLabel_Email_Message.setVisible(false);
        jLabel_Username_Message.setVisible(false);
        jLabel_Password_Message.setVisible(false);
        jLabel_ConPassword_Message.setVisible(false);
        
        
        // check email and user that is not invalid format
        if (!isEmailValid(email)) {
            // handle invalid email format
            jLabel_Email_Message.setVisible(true);
            jLabel_Email_Message.setText("Invalid email format!");
            return;
        }


        if (!isUsernameValid(username)) {
            // handle invalid username format
            jLabel_Username_Message.setVisible(true);
            jLabel_Username_Message.setText("Invalid username format!");
            return;

            
        } if (password.trim().isEmpty()){
            jLabel_Password_Message.setVisible(true);



        } else if (!password.equals(conpassword)){
            jLabel_ConPassword_Message.setVisible(true);
            jLabel_ConPassword_Message.setText("The passwords do not match.");
        
            

        } else if (!email.trim().isEmpty() && !username.trim().isEmpty() && !password.trim().isEmpty() && (password.equals(conpassword))){
            registrationSystem.checkData(jTextField_Email.getText(), jTextField_Username.getText(), String.valueOf(jPasswordtField_Password.getPassword()), String.valueOf(jPasswordField_ConfirmPassword.getPassword()));

    }//GEN-LAST:event_jButtonSignUpMouseClicked

}
    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        //</editor-fold>
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException | InstantiationException | IllegalAccessException | javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(RegisterForm.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        /* Create and display the form */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new RegisterForm().setVisible(true);
            }
        });
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton jButtonSignUp;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JLabel jLabel9;
    private javax.swing.JLabel jLabelClose;
    private javax.swing.JLabel jLabelLoginForm;
    private javax.swing.JLabel jLabelMin;
    private javax.swing.JLabel jLabel_ConPassword_Message;
    private javax.swing.JLabel jLabel_Email;
    private javax.swing.JLabel jLabel_Email_Message;
    private javax.swing.JLabel jLabel_Password_Message;
    private javax.swing.JLabel jLabel_Username_Message;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JPanel jPanel4;
    private javax.swing.JPanel jPanel5;
    private javax.swing.JPanel jPanel6;
    private javax.swing.JPasswordField jPasswordField_ConfirmPassword;
    private javax.swing.JPasswordField jPasswordtField_Password;
    private javax.swing.JTextField jTextField_Email;
    private javax.swing.JTextField jTextField_Username;
    private javax.swing.JLabel status_request_lbl;
    // End of variables declaration//GEN-END:variables


    
        //-------------------------
        // GETTER AND SETTER.
        //-------------------------
    
    
    public JButton getjButtonSignUp() {
        return jButtonSignUp;
    }

    public void setjButtonSignUp(JButton jButtonSignUp) {
        this.jButtonSignUp = jButtonSignUp;
    }


    public JLabel getjLabel_Email_Message() {
        return jLabel_Email_Message;
    }

    public void setjLabel_Email_Message(JLabel jLabel_Email_Message) {
        this.jLabel_Email_Message = jLabel_Email_Message;
    }

    public JLabel getjLabel_Password_Message() {
        return jLabel_Password_Message;
    }

    public void setjLabel_Password_Message(JLabel jLabel_Password_Message) {
        this.jLabel_Password_Message = jLabel_Password_Message;
    }

    public JLabel getjLabel_Username_Message() {
        return jLabel_Username_Message;
    }

    public void setjLabel_Username_Message(JLabel jLabel_Username_Message) {
        this.jLabel_Username_Message = jLabel_Username_Message;
    }

    public JPasswordField getjPasswordField_ConfirmPassword() {
        return jPasswordField_ConfirmPassword;
    }

    public void setjPasswordField_ConfirmPassword(JPasswordField jPasswordField_ConfirmPassword) {
        this.jPasswordField_ConfirmPassword = jPasswordField_ConfirmPassword;
    }

    public JPasswordField getjPasswordtField_Password() {
        return jPasswordtField_Password;
    }

    public void setjPasswordtField_Password(JPasswordField jPasswordtField_Password) {
        this.jPasswordtField_Password = jPasswordtField_Password;
    }

    public JTextField getjTextField_Email() {
        return jTextField_Email;
    }

    public void setjTextField_Email(JTextField jTextField_Email) {
        this.jTextField_Email = jTextField_Email;
    }

    public JTextField getjTextField_Username() {
        return jTextField_Username;
    }

    public void setjTextField_Username(JTextField jTextField_Username) {
        this.jTextField_Username = jTextField_Username;
    }

    public JLabel getjLabel_ConPassword_Message() {
        return jLabel_ConPassword_Message;
    }

    public void setjLabel_ConPassword_Message(JLabel jLabel_ConPassword_Message) {
        this.jLabel_ConPassword_Message = jLabel_ConPassword_Message;
    }

}



